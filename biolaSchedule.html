<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schedule Generator</title>
    <style>
        :root {
            font-family: Helvetica;
        }
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
            /* border-radius: 5px; */

        }
        td {
            /* border-collapse: collapse; */

        }
        .black {
            background-color: black;
            color: white;
        }
        .color1{
            color: white;
            background-color: #ff0001;
        }
        .color2{
            color: white;
            background-color: #ff6d00;
        }
        .color3{
            color: white;
            background-color: #f0c233;
        }
        .color4{
            color: white;
            background-color: #69a94e;
        }
        .color5{
            color: white;
            background-color: #4386f4;
        }
        .color6{
            color: white;
            background-color: #9b01ff;
        }
        .color7{
            color: white;
            background-color: #fe00ff;
        }
    </style>
    <script>
        async function get(url){
            return new Promise( (resolve, reject) => {
                fetch(url)
                .then(response => response.json())
                .then(data => resolve(data));
            })
        }
        function initializeTable(){
            let times = ["8:00","8:30","9:00","9:30","10:00","10:30","11:00","11:30","12:00","12:30","1:00","1:30","2:00","2:30","3:00","3:30","4:00","4:30","5:00","5:30","6:00","6:30","7:00","7:30","8:00","8:30","9:00"]

            for(let time of times){
                let rowHTML =
                    `<tr id="${time}">
                    <th class="black">${time}</th>
                    <td class="Sunday"></td>
                    <td class="Monday"></td>
                    <td class="Tuesday"></td>
                    <td class="Wednesday"></td>
                    <td class="Thursday"></td>
                    <td class="Friday"></td>
                    <td class="Saturday"></td>
                    </tr>`
                document.getElementById("schedule").innerHTML += rowHTML
            }
        }
        async function initializeLegend(){
            let courses = ["BBST 251","PHIL 215","MATH 203","HIST 200","ENGL 220","ENGL 313"]
            let crns = ["5093","5206","5287","5384","5539","5505"]
            let url = "https://mastertemple.github.io/api/biola/courses/2022/spring/CRNs.json"

            let crnList = await get(url)
            let subjects = []
            for(let crn of crns){
                subjects.push(crnList[crn])
            }
            subjects = [...new Set([...subjects])]
            let courseData = []
            for(let subject of subjects){
                let data = await get(`https://mastertemple.github.io/api/biola/courses/2022/spring/${subject}.json`)
                courseData = [...courseData, ...data.filter(({CRN}) => crns.includes(CRN))]
            }
            console.log(courseData);

            let colors = ["#ff0001","#ff6d00","#f0c233","#69a94e","#4386f4","#9b01ff","#fe00ff"]
            let c = 1
            for(let course of courses){
                let rowHTML =
                `<th class="id color${c}">${course}</th>
                <th class="courseTitle color${c}"></th>
                <th class="room color${c}"></th>
                <th class="CRN color${c}"></th>
                </tr>`
                document.getElementById("legend").innerHTML += rowHTML
                c++
            }
        }
        document.addEventListener("DOMContentLoaded", function(event) {
            initializeTable()
            initializeLegend()
        });


    </script>
</head>
<body>
    <h1>Biola Spring 2022 Class Schedule</h1>
    <table id="schedule">
        <tr id="headers">

            <th class="black">Time</th>
            <th class="black">Sunday</th>
            <th class="black">Monday</th>
            <th class="black">Tuesday</th>
            <th class="black">Wednesday</th>
            <th class="black">Thursday</th>
            <th class="black">Friday</th>
            <th class="black">Saturday</th>
        </tr>
        <tr id="row1">
        </tr>
      </table>
      <br>

      <table id="legend">
        <tr id="headers">
            <th class="black">Course</th>
            <th class="black">Title</th>
            <th class="black">Room</th>
            <th class="black">CRN</th>
        </tr>
        <tr id="row1">
        </tr>

      </table>
</body>
</html>